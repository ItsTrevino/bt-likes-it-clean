<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>BT Likes It</title>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    #canvas {
      display: block;
      margin: 0 auto;
    }
    input {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>BT ðŸ’›</h1>
  <input type="text" id="firstname" placeholder="FÃ¶rnamn">
  <input type="text" id="lastname" placeholder="Efternamn eller &-namn">
  <br />
  <button onclick="generate()">Generera</button>
  <canvas id="canvas" width="1080" height="1350"></canvas>

  <script>
    const charToFilename = {
  'A': 'A', 'B': 'B', 'C': 'C', 'D': 'D', 'E': 'E',
  'F': 'F', 'G': 'G', 'H': 'H', 'I': 'I', 'J': 'J',
  'K': 'K', 'L': 'L', 'M': 'M', 'N': 'N', 'O': 'O',
  'P': 'P', 'Q': 'Q', 'R': 'R', 'S': 'S', 'T': 'T',
  'U': 'U', 'V': 'V', 'W': 'W', 'X': 'X', 'Y': 'Y',
  'Z': 'Z', 'Ã…': 'Ã…', 'Ã„': 'Ã„', 'Ã–': 'Ã–', '&': '&'
};
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    async function loadImage(src) {
      return new Promise((resolve, reject) => {
        const img = new Image();
        img.onload = () => resolve(img);
        img.onerror = reject;
        img.src = src;
      });
    }

    async function loadLetterImages(name, letterHeight) {
      const spacing = 10;
      const letters = [];

      for (let char of name) {
        if (char === ' ') {
          letters.push({ type: 'space', width: spacing * 2 });
          continue;
        }
        const filename = charToFilename[char];
if (!filename) continue; // hoppar Ã¶ver okÃ¤nda tecken
const img = await loadImage(`images/${filename}.png`);
        const scale = letterHeight / img.height;
        const width = img.width * scale;
        letters.push({ type: 'letter', img, width, height: letterHeight });
      }

      const totalWidth = letters.reduce((sum, l) => sum + l.width + (l.type === 'letter' ? spacing : 0), -spacing); // no trailing space
      return { letters, totalWidth };
    }

    async function generate() {
      const firstName = document.getElementById('firstname').value.toUpperCase();
      const lastName = document.getElementById('lastname').value.toUpperCase();

      if (!firstName || !lastName) {
        alert("Skriv bÃ¥de fÃ¶r- och efternamn!");
        return;
      }

      try {
        const background = await loadImage('images/background.png');
        ctx.drawImage(background, 0, 0, canvas.width, canvas.height);

        const longest = Math.max(firstName.length, lastName.length);
        const letterHeight = Math.min(180, (canvas.width - 60) / longest);
        const spacing = 10;
        const topOffset = 115;
        const lineGap = letterHeight * 1.2;

        // Rita fÃ¶rnamn
        const firstData = await loadLetterImages(firstName, letterHeight);
        let x = (canvas.width - firstData.totalWidth) / 2;
        for (let item of firstData.letters) {
          if (item.type === 'space') {
            x += item.width;
          } else {
            ctx.drawImage(item.img, x, topOffset, item.width, letterHeight);
            x += item.width + spacing;
          }
        }

        // Rita efternamn
        const lastData = await loadLetterImages(lastName, letterHeight);
        x = (canvas.width - lastData.totalWidth) / 2;
        for (let item of lastData.letters) {
          if (item.type === 'space') {
            x += item.width;
          } else {
            ctx.drawImage(item.img, x, topOffset + lineGap, item.width, letterHeight);
            x += item.width + spacing;
          }
        }

        // Rita likes-it
        const likesIt = await loadImage('images/likes-it.png');
        const liHeight = letterHeight;
        const liScale = liHeight / likesIt.height;
        const liWidth = likesIt.width * liScale;
        const liX = (canvas.width - liWidth) / 2;
        const liY = topOffset + 2 * lineGap;
        ctx.drawImage(likesIt, liX, liY, liWidth, liHeight);

      } catch (err) {
        console.error("Fel under bildgenerering:", err);
        alert("NÃ¥got gick fel â€“ se konsolen fÃ¶r detaljer.");
      }
    }
  </script>
</body>
</html>
